version: '2'
services:
  swc-datastore:
    image: postgres:latest
    volumes:
      - /swcdbstore
    entrypoint: /bin/bash
  swc-db-server:
    image: postgres:latest
    volumes:
      - ./swc-datastore:/docker-entrypoint-initdb.d
    volumes_from:
      - swc-datastore
    environment:
      POSTGRES_PASSWORD: pgsecret
      PGDATA: /swcdbstore/pgdata
    ports:
      - "5432:5432"
  swc-upload:
    build: ./swc-upload
    environment:
      NODE_ENV: production
    command: node /app/app.js
    ports:
      - "9651:9651"
    links:
      - swc-db-server:database
    depends_on:
      - swc-db-server
